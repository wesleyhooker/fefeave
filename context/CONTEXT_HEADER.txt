?? Context Header - fefeave Project (2025-08-24)
Current State

Frontend CI/CD (dev)

Workflow: deploy-frontend.yml.

CloudFront distro is deployed, OAC + bucket policy are correct.

Problem: S3 bucket is empty after CI/CD run  CloudFront returns 403.

Manual local build + aws s3 sync works fine.

Likely causes:

ANGULAR_PROJECT repo var missing/wrong (should be frontend).

AWS_ROLE_ARN not set in repo vars (Terraform created it, but GH var may be missing).

To fix: confirm and set GH vars  re-run deploy  check if S3 contains index.html.

Backend CI

Workflow: ci-backend.yml runs npm ci, lint, test (safe with --if-present).

No backend deploy workflow yet.

Infrastructure

Terraform (infra/dev/) managing S3, CloudFront, IAM OIDC role.

outputs.tf exports cloudfront_distribution_id, s3_bucket_name, github_actions_role_arn.

Verified: bucket policy uses OAC + SourceArn correctly.

Next Steps

Check GH repo variables:

gh variable list -R wesleyhooker/fefeave


Ensure:

S3_BUCKET = fefeave-frontend-dev

CF_DIST_ID = E2AFMX1CBYH2E4

ANGULAR_PROJECT = frontend

AWS_ROLE_ARN = <IAM role ARN>

If AWS_ROLE_ARN missing:

terraform -chdir=infra/dev apply
terraform -chdir=infra/dev output -raw github_actions_role_arn
gh variable set -R wesleyhooker/fefeave AWS_ROLE_ARN --body "<above-value>"


Re-run deploy workflow:

gh workflow run deploy-frontend.yml -R wesleyhooker/fefeave


Confirm files land in S3:

aws s3 ls s3://fefeave-frontend-dev/index.html
aws s3 ls s3://fefeave-frontend-dev/ --recursive | head -n 20


Once index.html is in S3, your site should load at:
https://d2nbb1ussku5hv.cloudfront.net
.
├── README.md
├── backend
│   ├── Dockerfile
│   └── src
├── context
│   └── CONTEXT_HEADER.txt
├── docker-compose.yml
├── frontend
│   ├── Dockerfile
│   ├── angular.json
│   ├── package-lock.json
│   ├── package.json
│   ├── public
│   │   └── favicon.ico
│   ├── src
│   │   ├── app
│   │   │   ├── app.config.server.ts
│   │   │   ├── app.config.ts
│   │   │   ├── app.html
│   │   │   ├── app.routes.server.ts
│   │   │   ├── app.routes.ts
│   │   │   ├── app.scss
│   │   │   ├── app.spec.ts
│   │   │   └── app.ts
│   │   ├── index.html
│   │   ├── main.server.ts
│   │   ├── main.ts
│   │   ├── server.ts
│   │   └── styles.scss
│   ├── tsconfig.app.json
│   ├── tsconfig.json
│   └── tsconfig.spec.json
└── infra
    ├── README.md
    └── dev
        ├── cloudfront.tf
        ├── iam_gh_oidc.tf
        ├── main.tf
        ├── outputs.tf
        ├── providers.tf
        ├── s3.tf
        ├── s3_policy.tf
        ├── terraform.tfstate
        └── terraform.tfstate.backup

10 directories, 35 files
